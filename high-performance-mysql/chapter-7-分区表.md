### 分区表

#### 分区表
对用户来说, 分区表是一个独立的逻辑表, 但是底层由多个物理子表组成, 实现分区的代码实际上是对一组底层表的句柄对象的封装; 对分区表的请求, 都会通过句柄对象转化成对存储引擎的接口调用; 所以分区表对于客户端来说是透明的, 但是从底层的文件系统来看就可以发现每个分区表都有一个使用 `#` 分隔命名的表文件   
MySQL 实现分区表的方式是对底层的封装, 这意味着索引也是按照分区的子表定义的, 而没有全局索引; 分区的一个主要目的是将数据按照一个较粗的粒度分在不同的表中, 这样做可以将相关的数据存放在一起; 在下面的场景中, 分区可以起到非常大的作用
- 表非常大以至于无法全部都放在内存中
- 分区表的数据更容易维护
- 分区表的数据可以分布在不同的物理设备上
- 可以使用分区表来避免某些特殊的瓶颈
- 可以单独备份和恢复某个分区

##### 分区表的原理
如前所述, 分区表由多个相关的底层实现, 这些底层实现也是由句柄对象 (Handler object) 表示, 所以也可以直接访问各个分区; 存储引擎管理分区的各个底层表和管理普通表是一样的 (所有底层表都必须使用相同的存储引擎), 分区表的索引知识在各个底层表上各自加上一个完全相同的索引; 从存储引擎的角度来看, 底层表和一个普通的表没有任何不同, 存储引擎3也无须知道这是一个普通的表还是一个分区表的一个分区; 分区表上的操作按照下面操作逻辑进行
- SELECT 查询
当查询一个分区表的时候, 分区层先打开并锁住所有的底层表, 优化器先判断是否可以过滤部分分区, 然后再调用对应的存储引擎接口访问各个分区的数据
- INSERT 操作
当写入一条记录时, 分区层先打开并锁住所有的底层表, 然后确定哪个分区接收这条记录, 再将记录写入对应的底层表
- DELETE 操作
当删除一条记录时, 分区层先打开并锁住所有的底层表, 然后确定数据的对应分区, 最后对相应底层表进行删除操作
- UPDATE 操作
当更新一条记录时, 分区层先打开并锁住所有的底层表, MySQL 先确定需要更新的记录在哪个区, 然后取出数据并更新, 再判断更新后的数据应该放在哪个分区, 最后对底层表进行写入操作, 并对原数据所在的底层表进行删除操作

##### 分区表的类型
MySQL 支持多种分区表, 使用最多的是根据范围进行分区, 每个分区存储落在某个范围的记录, 分区表达式可以是列, 也可以是包含列的表达式; 除此之外, 还有一些其他的分区技术, 包括按键值进行分区, 使用数据函数进行分区等

##### 如何使用分区表
