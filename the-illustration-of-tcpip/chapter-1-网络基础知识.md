### 网络基础知识

#### 计算机网络出现的背景
##### 计算机的普及与多样化
TODO

##### 从独立模式到网络互连模式
计算机网络, 根据其规模可分为 WAN (Wide Area Network, 广域网) 和 LAN (Local Area Network, 局域网)

##### 从计算机通信到信息通信
TODO

##### 计算机网络的作用
TODO

#### 计算机与网络发展的 7 个阶段
##### 批处理
批处理 (Batch Processing) 是指事先将用户程序和数据装入卡带或磁带, 并由计算机按照一定的顺序读取, 使用户所要执行的这些程序和数据能够一并批量得到处理的方式

##### 分时系统
分时系统 (TSS) 是指多个终端与同一个计算机连接, 允许多个用户同时使用一台计算机的系统; 分时系统的重要特性即独占性

##### 计算机之间的通信
在计算机间的通信技术诞生之前, 想要将一台计算机中的数据转移到另一台计算机中是相当繁琐的, 必须借助磁盘, 软盘等外部存储介质

##### 计算机网络的产生
20 世纪 70 年代初期人们开始实验基于分组交换技术的计算机网络, 到了 80 年代, 一种能够互连多种计算机的网络随之诞生

##### 互联网的普及
20 世纪 90 年代, 电子邮件, 万维网等信息传播方式如雨后春笋般迎来了前所未有的发展, 使得互联网得以广泛普及

##### 以互联网技术为中心的时代
曾经一直作为通信基础设施, 支撑通信网络的电话网, 随着互联网的快速发展, 其地位也随着时间的推移为 IP (internet Protocol) 网所取代, 而 IP 网本身就是互联网技术的产物

##### 从 "单纯建立连接" 到 "安全建立连接"
在互联网普及的初期, 人们更关注单纯的连接性, 以不受任何限制地建立互联网连接为最终目的, 然而现在, 人们以不再满足于 "单纯建立连接", 而是更为追求 "安全建立连接" 的目标

| 年份 | 内容 |
| :--- | :--- |
| 20 世纪 50 年代 | 批处理时代 |
| 20 世纪 60 年代 | 分时系统时代 |
| 20 世纪 70 年代 | 计算机间通信时代 |
| 20 世纪 80 年代 | 计算机网络时代 |
| 20 世纪 90 年代 | 互联网普及时代 |
| 2000 年 | 以互联网为中心的时代 |
| 2010 年 | 无论何时何地一切皆 TCP/IP 的网络时代 |

##### 手握金刚钻的 TCP/IP
TCP/IP 是通信协议的统称, 这里有必要先理清 "协议" 的概念

#### 协议
##### 随处可见的协议
| 网络体系结构 | 协议 | 主要用途 |
| :--- | :--- | :--- |
| TCP/IP | IP, ICMP, TCP, UDP, HTTP, TELNET, SNMP, SMTP, ... | 互联网, 局域网 |
| IPX/SPX | IPX, SPX, NPC, ... | 个人电脑局域网 |
| AppleTalk | DDP, RTMP, AEP, ATP, ZIP, ... | 苹果公司现有产品的局域网 |
| DECent | DPR, DSP, SCP, ... | 前 DEC 小型机 |
| OSI | FTAM, MOTIS, VT, CMIS/CMIP, CLNP, CONP, ... | - |
| XNS | IDP, SPP, PEP | 施乐公司网络 |

##### 协议的必要性
简单来说, 协议就是计算机之间通过网络实现通信时实现达成的一种 "约定", 这种 "约定" 使哪些不同厂商的设备, 不同的 CPU 以及不同的操作系统组成的计算机之间, 只要遵循相同的协议就能实现通信, 反之如果所使用的协议不同, 就无法实现通信

##### 协议如同人与人的对话
举个例子， 有三个人 A, B, C: A 只会说汉语, B 只会说英语, C 即会说汉语也会说英语
- 将汉语和英语当作 "协议"
- 将聊天当作 "通信"
- 将说话的内容当作 "数据"

那么 A 与 B 之间由于各持一种语言, 恐怕说多久也无法交流, 因为他们之间谈话所用的协议 (语言) 不同, 双方都无法将数据 (所说的话)传递给对方

##### 计算机中的协议
人类具有掌握知识的能力, 对所学知识也有一定的应用能力和理解能力, 因此在某种程度上, 人与人之间的沟通并不受限于太多规则; 但计算机从物理连接层面到应用程序的软件层面, 各个组件都必须严格遵循着事先达成的约定才能实现真正的通信; 此外人类在对话时有很高的容错机制, 说话顺序, 漏词等一些问题并不影响沟通, 但计算机做不到这一点, 因此在设计计算机程序和硬件时要充分考虑通信过程中可能遇到的各种异常以及对异常的处理  
在计算机通信中, 事先达成一个详细的约定, 并遵循这一约定进行处理尤为重要; 这种约定就是 "协议"

##### 分组交换协议
分组交换是将大数据分割为一个个叫做包 (Packet) 的较小单位进行传输的方法; 如同平常在邮局中见到的邮包  
当人们邮寄包裹时, 通常会填写一个寄件单贴在包裹上再交给邮局, 寄件单撒谎功能一般会有寄件人和收件人的详细地址; 类似的, 计算机通信也会在每一个分组中附加上源主机地址和目标主机地址送给通信线路; 这些发送端地址, 接收端地址, 以及分组序号写入的部分称为 "报文首部"  
一个较大的数被分为多个分组时, 为了标明是原始数据中的哪一部分, 就有必要将分组的需要写入包中, 接收端会根据这个序号再将每个分组按照序号重新装配为原始数据  
通信协议中, 通常会规定报文首部应该写入哪些信息, 应该如何处理这些信息; 相互通信的每一台计算机则根据协议构造报文首部, 读取首部内容等, 为了双方能正确通信, 分组的发送方和接收方有必要对报文首部和内容保持一致的定义和解释

#### 协议由谁规定
##### 计算机通信的诞生及其标准化
早期各家厂商的各种网络体系结构, 各种协议之间并不相互兼容, 即使从物理层面上连接了两台异构的计算机, 由于它们之间采用的网络体系结构不同, 支持的协议不同, 仍然无法实现正常的通信; 随着计算机重要性的不断提高, 很多公司逐渐意识到兼容性的重要意义

##### 协议的标准化
为了解决上述问题, ISO (Internetional Origanization for Standards) 制定了一个国际标准 OSI (Open Systems interconnection), 对通信系统进行了标准化; 现在 OSI 定义的协议虽然并没有得到普及, 但是在 OSI 协议设计之初作为其指导方针却常用于网络协议的制定中  
TCP/IP 并非 OSI 制定的某种国际标准, 而是由 IETF 所建议的, 致力于推进其标准化作业的一种协议, 当时大学等研究机构额计算机行业作为中心力量, 推动了 TCP/IP 的标准化进程, TCP/IP 作为互联网上的一种标准, 也作为业界标准, 已俨然成为了全世界广泛应用的通信协议

#### 协议分层与 OSI 参考模型
OSI 这一模型将通信协议中必要的功能分成了 7 层, 通过这些分层使得比较复杂的网络协议更加简单化; 在这一模型中, 每个分层都接收由它下一层所提供的特定服务, 并且负责为自己的上一层提供特定的服务, 上下层之间进行交互时遵循的约定叫做 "接口", 同一层之间的交互所遵循的约定叫做 "协议"  
分层的优势是每层之间可以独立使用, 即使系统中某些分层发生变化, 也不会波及整个系统; 而劣势在于过于模块化, 使得处理变得更加沉重以及每个模块都不得不实现相似的处理逻辑

![协议的分层.png](http://ww1.sinaimg.cn/large/d8f31fa4gy1gb2hp0uf5hj20d10dkglz.jpg)
##### 通过对话理解分层
TODO

##### OSI 参考模型
| 层级 | 层级名称 |
| :--- | :--- |
| 7 | 应用层 |
| 6 | 表示层 |
| 5 | 会话层 |
| 4 | 传输层 |
| 3 | 网络层 |
| 2 | 数据链路层 |
| 1 | 物理层 |

OSI 参考模型中定义了每一层的作用; 定义每一层的作用的是协议; 协议是约定,其具体内容为规范; 我们日常所使用的就是遵循各个协议具体规范的产品和通信手段

##### OSI 参考模型中各个分层的作用
| 层级 | 分层名称 | 功能 | 每层功能概览 |
| :--- | :--- | :--- | :--- |
| 7 | 应用层 | 针对特定应用的协议 | 电子邮件协议, 远程登录协议, 文件传输协议 |
| 6 | 表示层 | 设备固有数据格式和网络标准数据格式的转换 | 接收不同形式的信息, 如文字, 图像, 声音等 |
| 5 | 会话层 | 通信管理, 负责建立和断开通信连接 (数据流动的逻辑通路), 管理传输层以下的分层 | 何时建立连接, 何时断开连接以及保持多久的连接 |
| 4 | 传输层 | 管理两个节点之间的数据传输, 负责可靠传输 (确保数据被可靠地传送到目标地址) | 是否有数据丢失? |
| 3 | 网络层 | 地址管理与路由选择 | 经过哪个路由传递到目标地址 |
| 2 | 数据链路层 | 互连设备之间传送和识别数据帧 | 数据帧和比特流之间的转换 |
| 1 | 物理层 | 以 "0" 或 "1" 代表电压的高低, 灯光的闪灭, 界定连接器和网络的规格 | 比特流与电子信号之间的切换 |

- 应用层
为应用程序提供服务并规定应用程序中通信相关的细节, 包括文件传输, 电子邮件, 远程登录等协议
- 表示层
将应用处理的信息转换为适合网络传输的格式, 或将来自下一层的数据转换为上层能够处理的格式, 因此本层主要复制数据格式的转换
- 会话层
负责建立和断开通信连接, 以及数据分割等数据传输相关的管理
- 传输层
起可靠传输的作用, 只在通信双方节点上进行处理, 而无需在路由器上处理
- 网络层
将数据传输到目标地址, 目标地址可以是多个网络通过路由器连接而成的某一个地址, 因此这一层主要负责寻址和路由选择
- 数据链路层
负责物理层面上的互连节点之间的通信传输, 将 0, 1 划分为具有意义的数据帧传送给对端
- 物理层
负责 0, 1 比特流与电压的高低, 光与闪灭之间的互换

#### OSI 参考模型通信处理举例
##### 7 层通信
TODO
##### 会话层以上的处理
TODO
##### 传输层以下的处理
TODO

#### 传输方式的分类
##### 面向有连接型与面向无连接型
- 面向有连接型
面向有连接型中, 在发送数据之前, 需要在收发主机之间连接一条通信线路
- 面向无连接型
面向无连接型则不要求建立和断开连接, 发送端可于任何时候自由发送数据

##### 电路交换和分组交换
网络通信大致分为两种, 电路交换和分组交换; 电路交换的历史相对久远, 主要用于过去的电话网, 而分组交换则是一种较新的技术, TCP/IP 正是采用了分组交换技术  
在电路交换中, 交换机主要负责数据的中转处理, 计算机首先被连接到交换机上, 而交换机与交换机之间则由众多通信线路再继续连接; 因此计算机之间在发送数据时, 需要通过交换机与目标主机建立通信线路, 建立好连接之后用户就可以一直使用这条电路直到连接被断开为止; 在这种情况下, 一台计算机在收发信息时会独占整个电路, 其他计算机只能等待这台计算机处理结束后才有机会使用这条电路收发数据, 并且其他计算机也不能预测某一台计算机何时开始何时结束数据传输, 所以并发用户数超过交换机之间的线路树则无法通信  
为了解决这个问题提出了分组交换技术, 即让连接到通信电路的计算机将所要发送的数据分成多个数据包, 按照一定的顺序排列之后分别发送; 在分组交换中, 有分组交换机 (路由器) 连接通信线路, 分组交换大致的处理过程是: 发送端计算机将数据分组发送给路由器, 路由器收到这些分组数据以后, 缓存到自己的缓冲区, 然后再转发给目标计算机; 因此分组交换也有另一个名称: 蓄积交换; 路由器接收到数据以后会按照顺序缓存到相应的队列当中去, 再以先进先出的顺序将它们逐一发送出去; 在分组交换中, 计算机与路由器之间以及路由器与路由器之间通过只有一条通信线路, 这条线路其实是共享线路, 在电路交换中计算机之间的传输速度不变, 然而在分组交换中通信线路的速度可能会有所不同; 根据网络拥堵的情况, 数据达到目标地址的时间有长有短, 另外路由器的缓存饱和或溢出时, 甚至可能会发生分组数据丢失, 无法发送到对端的情况

##### 根据接收端数量分类
网络通信中, 也可以根据目标地址的个数及其后续的行为对通信进行分类
- 单播
指一对一通信, 典型的例子是固定电话
- 广播
指一台主机发送给与之相连的所有其他主机, 典型的例子是电视播放
- 多播
与广播类似, 也是将消息发送给多个接收主机, 不同之处在于多播要限定某一组主机作为接收端, 典型的例子是电视会议
- 任播
指在特定的多台主机中选出一台作为接收端的一种通信方式; 虽然这种方式与多播有相似之处, 都是面向特定的一群主机, 但是它的行为与多播不同, 任播通信从目标主机群中选择一台最符合网络条件的主机作为目标主机发送消息, 典型的例子是 DNS 根域名解析服务器

#### 地址
通信传输中, 发送端和接收端可以被视为通信主体, 它们都能由一个所谓的 "地址" 的信息加以标识; 在计算机网络通信中, 每一层协议所使用的地址都不尽相同, 例如 TCP/IP 使用 MAC 地址, IP 地址, 端口号等

##### 地址的唯一性
一个地址必须明确的表示一个主体对象, 在同一个通信网络中不允许有两个相同地址的通信主题存在, 这也就是地址的唯一性

##### 地址的层次性
当地址总数并不是很多的情况下, 有唯一性就可以定位相互通信的主体, 然而当地址总数越来越多时, 如何高效的从中找出通信的目标将称为一个重要的问题, 为此人们发现地址除了具有唯一性还需要具有层次性

#### 网络的构成要素
搭建网络的主要设别及其作用如下

| 设备 | 作用 |
| :--- | :--- |
| 网卡 | 使计算机连网的设备 |
| 中继器 | 从物理层上延长网络的设备 |
| 网桥 / 2 层交换机 | 从数据链路层上延长网络的设备 |
| 路由器 / 3 层交换机 | 通过网络层转发分组数据的设备 |
| 4 - 7 层交换机 | 处理传输层以上各层网络传输的设备 |
| 网关 | 转换协议的设备 |

##### 通信媒介与数据链路
计算机之间通过电缆相互连接; 以下是各种不同数据链路, 通信媒介及其标准传输速率

| 数据链路名 | 通信媒介 | 传输速率 | 主要用途 |
| :--- | :--- | :--- | :--- |
| 以太网 | 同轴电缆 | 10Mbps | LAN |
| - | 双绞线电缆 | 10Mbps ~ 100Gbps| LAN |
| - | 光纤电缆 | 10Mbps ~ 100Gbps| LAN |
| 无线 | 电磁波 | 数个 Mbps | LAN ~ WAN |
| ATM | 双绞线电缆/光纤电缆 | 25 / 155 / 622Mbps | LAN ~ WAN |
| FDDI | 双绞线电缆/光纤电缆 | 100Mbps| LAN ~ WAN |
| 帧中继 | 双绞线电缆/光纤电缆 | 约 64k ~ 1.5Mbps | WAN |
| ISDN | 双绞线电缆/光纤电缆 | 64k ~ 1.5Mbps | WAN |

##### 网卡
任何一台计算机连接网络时, 必须要使用网卡 (全称为网络接口卡), 网络接口卡 (NIC) 有时也被叫做网络适配器, 网卡, LAN 卡

##### 中继器
中继器 (Repeater) 是在 OSI 模型的第 1 层, 物理层上延长网络的设备, 由电缆传过来的电信号或光信号经由中继器的波形调整和放大再传给另一个电缆; 一般情况下中继器两端连接的是相同的通信媒介, 但优的中继器也可以完成不同媒介之间的转接工作; 有些中继器可以提供多个端口服务, 这种中继器被称作为中继集线器或者集线器, 所以集线器可以看作多口中继器, 每个端口都可以成为一个中继器

##### 网桥 / 2 层交换机
网桥是 OSI 模型上的第 2 层, 数据链路层上连接两个网络的设备, 它能够识别数据链路层中的数据帧, 并且将这些数据帧临时存储于内存, 再重新生成信号作为一个全新的帧发送给相连的另一个网段

##### 路由器 / 3 层交换机
路由器是在 OSI 模型的第 3 层, 网络层面上连接两个网络, 并对分组报文进行转发的设备; 网桥是根据物理地址 (MAC 地址) 进行处理, 而路由器 / 3 层交换机则是根据 IP 地址进行处理的, 由此 TCP/IP 中网络层的地址就成为了 IP 地址

##### 4 ~ 7 层交换机
4 ~ 7 层交换机负责处理 OSI 模型中从传输层至应用层的数据, 如果用 TCP/IP 分层模型来表述, 4 ~ 7 层交换机就是以 TCP 等协议的传输层及其上面的应用层为基础, 分析收发数据, 并对其进行特定的处理

##### 网关
网关是 OSI 参考模型中负责将传输层到应用层的数据进行转换和转发的设备; 它 于 4 ~ 7 层交换机一样都是处理传输层及以上的数据, 但是网关不仅转发数据还负责对数据进行转换, 它通常使用一个表示层或应用层网关, 在两个不能进行直接通信的协议之间进行翻译, 最终实现两者之间的通信

#### 现代网络实态
TODO
